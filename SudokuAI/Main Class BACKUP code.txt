import sys
import docker
from app.FileParsing import FileParsing
from app.PrintGrid import PrintGrid
from app.Backtracking import Backtracking
from app.Cell import Cell
from NeuralNetwork import extract_sudoku_grid
    

def grid_to_cells(grid):
    cells = []
    for r in range(9):
        for c in range(9):
            row = r + 1
            col = c + 1
            block = ((r // 3) * 3) + (c // 3) + 1
            num = str(grid[r][c]) if grid[r][c] != 0 else "."
            cell = Cell(num, row, col, block)
            cells.append(cell)
    return cells

def main():
    # Example usage ---------------------------------------

    image_path = "TestCase1.jpg"  # replace with your file
    grid = extract_sudoku_grid(image_path)

    for row in grid:
        print(row)
    
    # Creates cellList
    cell_list = []
    if len(sys.argv) > 1:        # Use CNN to read from image
        print("Grid read from image:")
    else:
        # Opens a file and gets the board
        get_cell_file = FileParsing()
        cell_list = get_cell_file.open_file()
        print("Grid read from file:")

    # Prints the initial sudoku state
    console_printer = PrintGrid()
    console_printer.print_numbers(cell_list)

    # SearchAlgorithm search = new SearchAlgorithm(cellList);
    # search.Search();

    search2 = Backtracking()
    search2.add_first(cell_list)
    cell_list = search2.backtracker_search()

    console_printer.print_numbers(cell_list)

if __name__ == "__main__":
    main();